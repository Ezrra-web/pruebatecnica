@{
    ViewData["Title"] = "Nuevo Registro";
}

<div class="container mt-4">
    <h2 class="mb-4 text-center">Nuevo Registro</h2>

    <form asp-action="Crear" method="post" class="card p-4 shadow">
        <div class="mb-3">
            <label for="nombre">Nombre:</label>
            <input type="text" name="nombre" id="nombre" class="form-control"
                   pattern="[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+"
                   title="Solo letras y espacios" required />
        </div>

        <div class="mb-3">
            <label for="contrato">Contrato:</label>
            <input type="text" name="contrato" id="contrato" class="form-control"
                   pattern="[A-Za-z0-9]+"
                   title="Solo letras y números, sin caracteres especiales" required />
        </div>

        <div class="mb-3">
            <label for="saldo">Saldo:</label>
            <input type="number" name="saldo" id="saldo" class="form-control"
                   min="0" step="0.01"
                   title="No puede ser negativo" required />
        </div>
        <div class="mb-3">
            <label class="form-label">Fecha</label>
            <input type="date" name="fecha" class="form-control" required />
        </div>

        <div class="mb-3">
            <label for="telefono">Teléfono:</label>
            <input type="text" name="telefono" id="telefono" class="form-control"
                   pattern="[0-9]+"
                   title="Solo números" required maxlength="15" />
        </div>

        <div class="text-center">
            <button type="submit" class="btn btn-success">💾 Guardar</button>
            <a asp-action="Index" class="btn btn-secondary">↩️ Volver</a>
        </div>
    </form>
</div>
@if (ViewBag.Mensaje != null)
{
    <div class="alert alert-warning mt-2">@ViewBag.Mensaje</div>
}


<script>
    document.querySelector("form").addEventListener("submit", function (e) {
        const nombre = document.getElementById("nombre").value.trim();
        const contrato = document.getElementById("contrato").value.trim();
        const saldo = parseFloat(document.getElementById("saldo").value);
        const telefono = document.getElementById("telefono").value.trim();

        if (!/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/.test(nombre)) {
            alert("❌ El nombre solo puede contener letras y espacios.");
            e.preventDefault();
            return;
        }

        if (!/^[A-Za-z0-9]+$/.test(contrato)) {
            alert("❌ El contrato solo puede contener letras y números, sin caracteres especiales.");
            e.preventDefault();
            return;
        }

        if (saldo < =0) {
            alert("❌ El saldo no puede ser negativo o 0.");
            e.preventDefault();
            return;
        }

        if (!/^[0-9]+$/.test(telefono)) {
            alert("❌ El teléfono solo puede contener números.");
            e.preventDefault();
            return;
        }
    });
</script>
